<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<!--[if IE]><meta http-equiv="X-UA-Compatible" content="IE=edge"><![endif]-->
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 1.5.0">
<meta name="author" content="David Estes">
<title>Asset Pipeline Users Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic|Noto+Serif:400,400italic,700,700italic|Droid+Sans+Mono:400">
<style>
/* Asciidoctor default stylesheet | MIT License | http://asciidoctor.org */
/* Remove the comments around the @import statement below when using this as a custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic|Noto+Serif:400,400italic,700,700italic|Droid+Sans+Mono:400";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}
audio,canvas,video{display:inline-block}
audio:not([controls]){display:none;height:0}
[hidden],template{display:none}
script{display:none!important}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
body{margin:0}
a{background:transparent}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
input[type="search"]{-webkit-appearance:textfield;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;box-sizing:content-box}
input[type="search"]::-webkit-search-cancel-button,input[type="search"]::-webkit-search-decoration{-webkit-appearance:none}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*:before,*:after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
#map_canvas img,#map_canvas embed,#map_canvas object,.map_canvas img,.map_canvas embed,.map_canvas object{max-width:none!important}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
.antialiased,body{-webkit-font-smoothing:antialiased}
img{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
p.lead,.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{font-size:1.21875em;line-height:1.6}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0;direction:ltr}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:none}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #ddddd8;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol,ul.no-bullet,ol.no-bullet{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ul.no-bullet{list-style:none}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote cite{display:block;font-size:.9375em;color:rgba(0,0,0,.6)}
blockquote cite:before{content:"\2014 \0020"}
blockquote cite a,blockquote cite a:visited{color:rgba(0,0,0,.6)}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media only screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede}
table thead,table tfoot{background:#f7f8f7;font-weight:bold}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt,table tr:nth-of-type(even){background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{display:table-cell;line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.clearfix:before,.clearfix:after,.float-group:before,.float-group:after{content:" ";display:table}
.clearfix:after,.float-group:after{clear:both}
*:not(pre)>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background-color:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre,pre>code{line-height:1.45;color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;text-rendering:optimizeSpeed}
.keyseq{color:rgba(51,51,51,.8)}
kbd{display:inline-block;color:rgba(0,0,0,.8);font-size:.75em;line-height:1.4;background-color:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:-.15em .15em 0 .15em;padding:.2em .6em .2em .5em;vertical-align:middle;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menu{color:rgba(0,0,0,.8)}
b.button:before,b.button:after{position:relative;top:-1px;font-weight:400}
b.button:before{content:"[";padding:0 3px 0 2px}
b.button:after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header:before,#header:after,#content:before,#content:after,#footnotes:before,#footnotes:after,#footer:before,#footer:after{content:" ";display:table}
#header:after,#content:after,#footnotes:after,#footer:after{clear:both}
#content{margin-top:1.25em}
#content:before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #ddddd8}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #ddddd8;padding-bottom:8px}
#header .details{border-bottom:1px solid #ddddd8;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span:before{content:"\00a0\2013\00a0"}
#header .details br+span.author:before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark:before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber:after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #ddddd8;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #efefed;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media only screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background-color:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #efefed;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #efefed;left:auto;right:0}}@media only screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:100%;background-color:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
.sect1{padding-bottom:.625em}
@media only screen and (min-width:768px){.sect1{padding-bottom:1.25em}}.sect1+.sect1{border-top:1px solid #efefed}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor:before,h2>a.anchor:before,h3>a.anchor:before,#toctitle>a.anchor:before,.sidebarblock>.content>.title>a.anchor:before,h4>a.anchor:before,h5>a.anchor:before,h6>a.anchor:before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock>caption.title{white-space:nowrap;overflow:visible;max-width:0}
.paragraph.lead>p,#preamble>.sectionbody>.paragraph:first-of-type p{color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>.paragraph:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #ddddd8;color:rgba(0,0,0,.6)}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock pre:not(.highlight),.listingblock pre[class="highlight"],.listingblock pre[class^="highlight "],.listingblock pre.CodeRay,.listingblock pre.prettyprint{background:#f7f7f8}
.sidebarblock .literalblock pre,.sidebarblock .listingblock pre:not(.highlight),.sidebarblock .listingblock pre[class="highlight"],.sidebarblock .listingblock pre[class^="highlight "],.sidebarblock .listingblock pre.CodeRay,.sidebarblock .listingblock pre.prettyprint{background:#f2f1f1}
.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{-webkit-border-radius:4px;border-radius:4px;word-wrap:break-word;padding:1em;font-size:.8125em}
.literalblock pre.nowrap,.literalblock pre[class].nowrap,.listingblock pre.nowrap,.listingblock pre[class].nowrap{overflow-x:auto;white-space:pre;word-wrap:normal}
@media only screen and (min-width:768px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:.90625em}}@media only screen and (min-width:1280px){.literalblock pre,.literalblock pre[class],.listingblock pre,.listingblock pre[class]{font-size:1em}}.literalblock.output pre{color:#f7f7f8;background-color:rgba(0,0,0,.9)}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.listingblock>.content{position:relative}
.listingblock code[data-lang]:before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:#999}
.listingblock:hover code[data-lang]:before{display:block}
.listingblock.terminal pre .command:before{content:attr(data-prompt);padding-right:.5em;color:#999}
.listingblock.terminal pre .command:not([data-prompt]):before{content:"$"}
table.pyhltable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.pyhltable td{vertical-align:top;padding-top:0;padding-bottom:0}
table.pyhltable td.code{padding-left:.75em;padding-right:0}
pre.pygments .lineno,table.pyhltable td:not(.code){color:#999;padding-left:0;padding-right:.5em;border-right:1px solid #ddddd8}
pre.pygments .lineno{display:inline-block;margin-right:.25em}
table.pyhltable .linenodiv{background:none!important;padding-right:0!important}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock blockquote p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote:before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.5em;margin-right:.5ex;text-align:right}
.quoteblock .quoteblock{margin-left:0;margin-right:0;padding:.5em 0;border-left:3px solid rgba(0,0,0,.6)}
.quoteblock .quoteblock blockquote{padding:0 0 0 .75em}
.quoteblock .quoteblock blockquote:before{display:none}
.verseblock{margin:0 1em 1.25em 1em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.05em;color:rgba(0,0,0,.6)}
.quoteblock.abstract{margin:0 0 1.25em 0;display:block}
.quoteblock.abstract blockquote,.quoteblock.abstract blockquote p{text-align:left;word-spacing:0}
.quoteblock.abstract blockquote:before,.quoteblock.abstract blockquote p:first-of-type:before{display:none}
table.tableblock{max-width:100%;border-collapse:separate}
table.tableblock td>.paragraph:last-child p>p:last-child,table.tableblock th>p:last-child,table.tableblock td>p:last-child{margin-bottom:0}
table.spread{width:100%}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all th.tableblock,table.grid-all td.tableblock{border-width:0 1px 1px 0}
table.grid-all tfoot>tr>th.tableblock,table.grid-all tfoot>tr>td.tableblock{border-width:1px 1px 0 0}
table.grid-cols th.tableblock,table.grid-cols td.tableblock{border-width:0 1px 0 0}
table.grid-all *>tr>.tableblock:last-child,table.grid-cols *>tr>.tableblock:last-child{border-right-width:0}
table.grid-rows th.tableblock,table.grid-rows td.tableblock{border-width:0 0 1px 0}
table.grid-all tbody>tr:last-child>th.tableblock,table.grid-all tbody>tr:last-child>td.tableblock,table.grid-all thead:last-child>tr>th.tableblock,table.grid-rows tbody>tr:last-child>th.tableblock,table.grid-rows tbody>tr:last-child>td.tableblock,table.grid-rows thead:last-child>tr>th.tableblock{border-bottom-width:0}
table.grid-rows tfoot>tr>th.tableblock,table.grid-rows tfoot>tr>td.tableblock{border-width:1px 0 0 0}
table.frame-all{border-width:1px}
table.frame-sides{border-width:0 1px}
table.frame-topbot{border-width:1px 0}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{display:table-cell;line-height:1.6;background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
td>div.verse{white-space:pre}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.unstyled,ol.unnumbered,ul.checklist,ul.none{list-style-type:none}
ul.unstyled,ol.unnumbered,ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-check-square-o:first-child,ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{position:relative;top:1px}
ul.inline{margin:0 auto .625em auto;margin-left:-1.375em;margin-right:0;padding:0;list-style:none;overflow:hidden}
ul.inline>li{list-style:none;float:left;margin-left:1.375em;display:block}
ul.inline>li>*{display:block}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1{padding-right:.75em;font-weight:bold}
td.hdlist1,td.hdlist2{vertical-align:top}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist>table tr>td:first-of-type{padding:0 .75em;line-height:1}
.colist>table tr>td:last-of-type{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left,.imageblock[style*="float: left"]{margin:.25em .625em 1.25em 0}
.imageblock.right,.imageblock[style*="float: right"]{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none}
span.footnote,span.footnoteref{vertical-align:super;font-size:.875em}
span.footnote a,span.footnoteref a{text-decoration:none}
span.footnote a:active,span.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em 0;border-width:1px 0 0 0}
#footnotes .footnote{padding:0 .375em;line-height:1.3;font-size:.875em;margin-left:1.2em;text-indent:-1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background-color:#00fafa}
.black{color:#000}
.black-background{background-color:#000}
.blue{color:#0000bf}
.blue-background{background-color:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background-color:#fa00fa}
.gray{color:#606060}
.gray-background{background-color:#7d7d7d}
.green{color:#006000}
.green-background{background-color:#007d00}
.lime{color:#00bf00}
.lime-background{background-color:#00fa00}
.maroon{color:#600000}
.maroon-background{background-color:#7d0000}
.navy{color:#000060}
.navy-background{background-color:#00007d}
.olive{color:#606000}
.olive-background{background-color:#7d7d00}
.purple{color:#600060}
.purple-background{background-color:#7d007d}
.red{color:#bf0000}
.red-background{background-color:#fa0000}
.silver{color:#909090}
.silver-background{background-color:#bcbcbc}
.teal{color:#006060}
.teal-background{background-color:#007d7d}
.white{color:#bfbfbf}
.white-background{background-color:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background-color:#fafa00}
span.icon>.fa{cursor:default}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note:before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip:before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning:before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution:before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important:before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background-color:rgba(0,0,0,.8);-webkit-border-radius:100px;border-radius:100px;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]:after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
h1,h2{letter-spacing:-.01em}
dt,th.tableblock,td.content{text-rendering:optimizeLegibility}
p,td.content{letter-spacing:-.01em}
p strong,td.content strong{letter-spacing:-.005em}
p,blockquote,dt,td.content{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background-color:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@media print{@page{margin:1.25cm .75cm}
*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare):after,a[href^="https:"]:not(.bare):after,a[href^="mailto:"]:not(.bare):after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]:after{content:" (" attr(title) ")"}
pre,blockquote,tr,img{page-break-inside:avoid}
thead{display:table-header-group}
img{max-width:100%!important}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #ddddd8!important;padding-bottom:0!important}
.sect1{padding-bottom:0!important}
.sect1+.sect1{border:0!important}
#header>h1:first-child{margin-top:1.25rem}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em 0}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span:before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]:before{display:block}
#footer{background:none!important;padding:0 .9375em}
#footer-text{color:rgba(0,0,0,.6)!important;font-size:.9em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
</style>
<style>
/* Stylesheet for CodeRay to match GitHub theme | MIT License | http://foundation.zurb.com */
/*pre.CodeRay {background-color:#f7f7f8;}*/
.CodeRay .line-numbers{border-right:1px solid #d8d8d8;padding:0 0.5em 0 .25em}
.CodeRay span.line-numbers{display:inline-block;margin-right:.5em;color:rgba(0,0,0,.3)}
.CodeRay .line-numbers strong{font-weight: normal}
table.CodeRay{border-collapse:separate;border-spacing:0;margin-bottom:0;border:0;background:none}
table.CodeRay td{vertical-align: top}
table.CodeRay td.line-numbers{text-align:right}
table.CodeRay td.line-numbers>pre{padding:0;color:rgba(0,0,0,.3)}
table.CodeRay td.code{padding:0 0 0 .5em}
table.CodeRay td.code>pre{padding:0}
.CodeRay .debug{color:#fff !important;background:#000080 !important}
.CodeRay .annotation{color:#007}
.CodeRay .attribute-name{color:#000080}
.CodeRay .attribute-value{color:#700}
.CodeRay .binary{color:#509}
.CodeRay .comment{color:#998;font-style:italic}
.CodeRay .char{color:#04d}
.CodeRay .char .content{color:#04d}
.CodeRay .char .delimiter{color:#039}
.CodeRay .class{color:#458;font-weight:bold}
.CodeRay .complex{color:#a08}
.CodeRay .constant,.CodeRay .predefined-constant{color:#008080}
.CodeRay .color{color:#099}
.CodeRay .class-variable{color:#369}
.CodeRay .decorator{color:#b0b}
.CodeRay .definition{color:#099}
.CodeRay .delimiter{color:#000}
.CodeRay .doc{color:#970}
.CodeRay .doctype{color:#34b}
.CodeRay .doc-string{color:#d42}
.CodeRay .escape{color:#666}
.CodeRay .entity{color:#800}
.CodeRay .error{color:#808}
.CodeRay .exception{color:inherit}
.CodeRay .filename{color:#099}
.CodeRay .function{color:#900;font-weight:bold}
.CodeRay .global-variable{color:#008080}
.CodeRay .hex{color:#058}
.CodeRay .integer,.CodeRay .float{color:#099}
.CodeRay .include{color:#555}
.CodeRay .inline{color:#00}
.CodeRay .inline .inline{background:#ccc}
.CodeRay .inline .inline .inline{background:#bbb}
.CodeRay .inline .inline-delimiter{color:#d14}
.CodeRay .inline-delimiter{color:#d14}
.CodeRay .important{color:#555;font-weight:bold}
.CodeRay .interpreted{color:#b2b}
.CodeRay .instance-variable{color:#008080}
.CodeRay .label{color:#970}
.CodeRay .local-variable{color:#963}
.CodeRay .octal{color:#40e}
.CodeRay .predefined{color:#369}
.CodeRay .preprocessor{color:#579}
.CodeRay .pseudo-class{color:#555}
.CodeRay .directive{font-weight:bold}
.CodeRay .type{font-weight:bold}
.CodeRay .predefined-type{color:inherit}
.CodeRay .reserved,.CodeRay .keyword {color:#000;font-weight:bold}
.CodeRay .key{color:#808}
.CodeRay .key .delimiter{color:#606}
.CodeRay .key .char{color:#80f}
.CodeRay .value{color:#088}
.CodeRay .regexp .delimiter{color:#808}
.CodeRay .regexp .content{color:#808}
.CodeRay .regexp .modifier{color:#808}
.CodeRay .regexp .char{color:#d14}
.CodeRay .regexp .function{color:#404;font-weight:bold}
.CodeRay .string{color:#d20}
.CodeRay .string .string .string{background:#ffd0d0}
.CodeRay .string .content{color:#d14}
.CodeRay .string .char{color:#d14}
.CodeRay .string .delimiter{color:#d14}
.CodeRay .shell{color:#d14}
.CodeRay .shell .delimiter{color:#d14}
.CodeRay .symbol{color:#990073}
.CodeRay .symbol .content{color:#a60}
.CodeRay .symbol .delimiter{color:#630}
.CodeRay .tag{color:#008080}
.CodeRay .tag-special{color:#d70}
.CodeRay .variable{color:#036}
.CodeRay .insert{background:#afa}
.CodeRay .delete{background:#faa}
.CodeRay .change{color:#aaf;background:#007}
.CodeRay .head{color:#f8f;background:#505}
.CodeRay .insert .insert{color:#080}
.CodeRay .delete .delete{color:#800}
.CodeRay .change .change{color:#66f}
.CodeRay .head .head{color:#f4f}
</style>
</head>
<body class="book toc2 toc-left">
<div id="header">
<h1>Asset Pipeline Users Guide</h1>
<div class="details">
<span id="author" class="author">David Estes</span><br>
<span id="email" class="email"><a href="mailto:davydotcom@gmail.com">davydotcom@gmail.com</a></span><br>
<span id="revdate">2.12.10</span>
</div>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#introduction">Introduction</a>
<ul class="sectlevel2">
<li><a href="#release-history">Release History</a></li>
</ul>
</li>
<li><a href="#concepts">Concepts</a>
<ul class="sectlevel2">
<li><a href="#directives">Directives</a></li>
<li><a href="#common-js">Common Js</a></li>
<li><a href="#project-structure">Project Structure</a></li>
<li><a href="#search-paths">Search Paths</a></li>
<li><a href="#build-structure">Build Structure</a></li>
<li><a href="#relative-urls">Relative Urls</a></li>
</ul>
</li>
<li><a href="#gradle">Gradle</a>
<ul class="sectlevel2">
<li><a href="#getting-started">Getting Started</a></li>
<li><a href="#configuration">Configuration</a></li>
<li><a href="#jvm-based-dependencies">JVM Based Dependencies</a></li>
</ul>
</li>
<li><a href="#grails3">Grails 3</a>
<ul class="sectlevel2">
<li><a href="#getting-started-2">Getting Started</a></li>
<li><a href="#configuration-2">Configuration</a></li>
<li><a href="#organization">Organization</a></li>
<li><a href="#taglibs">Taglibs</a></li>
</ul>
</li>
<li><a href="#grails2">Grails 2</a>
<ul class="sectlevel2">
<li><a href="#getting-started-3">Getting Started</a></li>
<li><a href="#configuration-3">Configuration</a></li>
<li><a href="#organization-2">Organization</a></li>
<li><a href="#taglibs-2">Taglibs</a></li>
</ul>
</li>
<li><a href="#ratpack">Ratpack</a>
<ul class="sectlevel2">
<li><a href="#getting-started-4">Getting Started</a></li>
</ul>
</li>
<li><a href="#spring-boot">Spring Boot</a>
<ul class="sectlevel2">
<li><a href="#getting-started-5">Getting Started</a></li>
</ul>
</li>
<li><a href="#modules">Plugin Modules</a>
<ul class="sectlevel2">
<li><a href="#less">LESS</a></li>
<li><a href="#sass">SASS</a></li>
<li><a href="#coffeescript">Coffeescript</a></li>
</ul>
</li>
<li><a href="#extending">Extending</a>
<ul class="sectlevel2">
<li><a href="#asset-file-definition">Asset File Definition</a></li>
<li><a href="#processors">Processors</a></li>
<li><a href="#post-processors">Post-Processors</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div class="sect1">
<h2 id="introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The asset-pipeline provides first class static and 'not so static' asset management for the JVM including many native framework integrations. It is highly extensible and provides processing of dynamic languages like LESS, SASS, Coffee, Typescript, and more. This goes beyond simple asset packaging and processing (making tools like grunt or webpack unnecessary for building high quality single page apps on the JVM), but also takes it a step further by providing features for optimally serving assets from your application as well.</p>
</div>
<div class="paragraph">
<p>This guide documents configuration and usage examples of the asset-pipeline plugin.</p>
</div>
<div class="sect2">
<h3 id="release-history">Release History</h3>
<div class="ulist">
<ul>
<li>
<p>January 24, 2017</p>
<div class="ulist">
<ul>
<li>
<p>2.12.10 - Fix a cache manager concurrancy bug and more jsx improvements</p>
</li>
</ul>
</div>
</li>
<li>
<p>January 16, 2017</p>
<div class="ulist">
<ul>
<li>
<p>2.12.7 - Fixes to jsx-asset-pipeline parsing in comment handling in expressions</p>
</li>
<li>
<p>2.12.6 - Fixes to jsx-asset-pipeline parsing in comment handling in expressions</p>
</li>
<li>
<p>* January 12, 2017</p>
</li>
<li>
<p>2.12.5 - Bug fixes in jsx processor</p>
</li>
</ul>
</div>
</li>
<li>
<p>January 2, 2017</p>
<div class="ulist">
<ul>
<li>
<p>2.12.2 - Bug fixes for Spring Boot and CompileStatic issue in AbstractAssetFile</p>
</li>
</ul>
</div>
</li>
<li>
<p>November 27, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.12.0 - Ecmascript 6 Module Loading Support using (.js.es6 or .jsx.es6) file extensions. Improved CommonJs support. Released at 30k ft!</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 28, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.11.6 - Fixing gradle bug with multiproject builds including assets from other projects.</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 27, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.11.5 - Improvements to JSX Transpiler with attribute value parsing</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 20, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.11.4 - Resolving Issue with tomcat grails container mode and assetResourceLocator</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 12, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.11.3 - Improvements to ratpack as well as several merged bug fixes.</p>
</li>
</ul>
</div>
</li>
<li>
<p>August 27, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.11.2 - Resolving issue with jsass not expiring cache dependencies. Also fixing bug in commonJs lib and allowing a config option to turn off commonJs.</p>
</li>
</ul>
</div>
</li>
<li>
<p>August 14, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.11.0 - Fixing Relative CommonJS Resolution and improving React JSX Parser to support newlines in assignment expressions. Also added JSX Parser Exception error handling</p>
</li>
</ul>
</div>
</li>
<li>
<p>August 5, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.10.2 - Improvements to CommonJS Cache Dependencies, Fixes to Cache Headers, and Relative URL replacement in HTML files</p>
</li>
<li>
<p>August 1, 2016</p>
</li>
<li>
<p>2.10.1 - Fixes for JSX and CommonJS</p>
</li>
</ul>
</div>
</li>
<li>
<p>July 28, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.10.0 - Added JSX Asset Pipeline Module and ES6 Support</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 16, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.9.4 Release - Bug fixes with grails bootup and copying files to external folder.</p>
</li>
<li>
<p>2.9.3 Release - Bug fixes with grails bootup and copying files to external folder.</p>
</li>
<li>
<p>2.9.2 Release - Bug fixes with grails bootup and copying files to external folder.</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 3, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.10.0 Release - Adds asset_url() method to javascript processing for resolving assets with properly digested names within your javascript files. See Concepts section on Relative Urls.</p>
</li>
</ul>
</div>
</li>
<li>
<p>May 24, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.9.1 Release - Fixes asset resolution issues with libsass in sass-asset-pipeline</p>
</li>
</ul>
</div>
</li>
<li>
<p>May 23, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.9.0 Release - sass-asset-pipeline moved to compass-asset-pipeline and new sass-asset-pipeline using jsass (libsass) added. New Documentation and Website release.</p>
</li>
</ul>
</div>
</li>
<li>
<p>April 22, 2016</p>
<div class="ulist">
<ul>
<li>
<p>2.8.0 Release - Bug fixes, New classpath resolver for binary plugin require_tree support. New asset-defer option for javascript taglib.</p>
</li>
<li>
<p>3.2.0 Release - Exploded plugin support, and jarTaskName support. Bug fixes, New classpath resolver for binary plugin require_tree support. New asset-defer option for javascript taglib.</p>
</li>
<li>
<p>April 5, 2016</p>
</li>
<li>
<p>3.1.3 , 2.7.4 Release - Fixes for webjar asset resolution or any binary dependency</p>
</li>
<li>
<p>March 24, 2016</p>
</li>
<li>
<p>3.1.2 Release - More aggressive closing of open file handles in Servlet filter for more efficient use of resources</p>
</li>
<li>
<p>2.7.2 Release - More aggressive closing of open file handles in Servlet filter for more efficient use of resources</p>
</li>
<li>
<p>March 9, 2016</p>
</li>
<li>
<p>3.1.1 Release - Improvements to compile time performance,fixed bootstrap bug, reducing open file handles</p>
</li>
<li>
<p>2.7.2 Release - Improvements to compile time performance, fixed bootstrap bug, and moving of .asscache to target folder</p>
</li>
<li>
<p>March 4, 2016</p>
</li>
<li>
<p>2.7.0 Release - Fixes bugs in filter and compiler</p>
</li>
<li>
<p>3.1.0 Release - 2.7.0 release of core for grails 3.1</p>
</li>
</ul>
</div>
</li>
<li>
<p>Nobember 24, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.6.7 Release - Core version bump with fixes for less4j and regex excludes support</p>
</li>
<li>
<p>3.0.15 (grails3) Release - Core version bump with fixes for less4j and regex excludes support</p>
</li>
</ul>
</div>
</li>
<li>
<p>November 16, 2015</p>
<div class="ulist">
<ul>
<li>
<p>3.0.14 (grails3) Release - Fixes a bug in SpringClassPath Resolver related to require_tree</p>
</li>
<li>
<p>2.6.6 Release - Fixes a bug in SpringClassPath resolver related to require_tree</p>
</li>
<li>
<p>3.0.12 (grails3) Release - Fixes to compile time performance and runtime using stream buffers</p>
</li>
<li>
<p>2.6.4 Release - Improved compile time performance</p>
</li>
</ul>
</div>
</li>
<li>
<p>November 11, 2015</p>
<div class="ulist">
<ul>
<li>
<p>3.0.11 (grails3) Release - Fixes to thread safety, and compile static fixes.</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 22, 2015</p>
<div class="ulist">
<ul>
<li>
<p>3.0.10 (grails3) Release - Cleaned up debug output</p>
</li>
<li>
<p>3.0.9 (grails3) Release - Asset Compiler is now streaming for binary files. Lower memory usage, faster builds. Production asset serving now caches resources for more speed. Fixed AssetResourceLocator in production mode</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 21, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.6.2 Release - less4j dependency updates for less Module</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 6, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.5.9 Release - More fixes to AssetResourceLocator</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 5, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.5.8 Release - More features for Last Modified date and If-Last-Modified headers. Also core bump with fixes for build phase</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 3, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.5.6 Release - Fixing bug in asset filter for cache</p>
</li>
<li>
<p>2.5.6 Release - Fixing bug in asset filter for cache</p>
</li>
<li>
<p>2.5.5 Release - Asset Compiler is now streaming for binary files. Lower memory usage, faster builds. Production asset serving now caches resources for more speed. Fixed AssetResourceLocator in production mode</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 2, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.5.4 Release - More enhancements to Last Modified headers, also fixes for jar resolution.</p>
</li>
</ul>
</div>
</li>
<li>
<p>September 29, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.5.2 Release - Add Last Modified Header as well as fixes to assetPathExists taglib</p>
</li>
</ul>
</div>
</li>
<li>
<p>August 21, 2015</p>
<div class="ulist">
<ul>
<li>
<p>3.0.8 Release - Added bundle=true attribute option to javascript and stylesheet taglib.</p>
</li>
<li>
<p>2.5.1 Release - Added bundle=true attribute option to javascript and stylesheet taglib.</p>
</li>
</ul>
</div>
</li>
<li>
<p>August 13, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.5.0 Release - Development Runtime cache is now persisted for faster load times! Gradle enhancements for resolvers and deduplicated plugins. Can also now include non digested files in war if needed. Added skipNonDigests config option.</p>
</li>
</ul>
</div>
</li>
<li>
<p>July 30, 2015</p>
<div class="ulist">
<ul>
<li>
<p>3.0.6 Grails3 Release - Fixes issues with extracted WAR containers</p>
</li>
</ul>
</div>
</li>
<li>
<p>July 29, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.4.3 Release - Fixes for gradle plugin portal only</p>
</li>
<li>
<p>2.4.2 Release - Fixes bug in CSS and HTML Relative URL digest replacement being inaccurate</p>
</li>
</ul>
</div>
</li>
<li>
<p>July 28, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.4.0 Release - Fixes bug in asset resolvers being overly aggressive about matching files with wrong extension type.</p>
</li>
</ul>
</div>
</li>
<li>
<p>July 2, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.3.9 Release - Fix in _AssetCompile gant script for buildDir, bad quotation used around string</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 30, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.3.8 Release - Fixes Jar asset injection for gradle and grails 3.x when assets.compileDir is non standard.</p>
</li>
<li>
<p>3.0.2 Grails 3 Module - Updated to work with changes to public class directives in core.</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 27, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.3.7 Release - Fixes to relative path replacement in css/html. Improvements in Angular @ngInject minification. Support for custom directives on files (i.e. //=wrapped)</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 19, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.3.2 Release - Fixes for html processor and performance improvements in css processor</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 18, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.3.0 Release - HtmlProcessor can now recalculate relative urls with digests on processing of static html. Fixed issues with classpath file resolution and cache. Better gradle support, boot support, and ratpack support.</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 16, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.2.5 Release - Fixing classpath resolution bug with cache.</p>
</li>
</ul>
</div>
</li>
<li>
<p>May 31, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.2.3 Release - No longer storing non digest versions in war file, cutting overhead in half. Also removed Commons i/o dependency. Faster byte stream.</p>
</li>
</ul>
</div>
</li>
<li>
<p>May 29, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.2.2 Release - Also now scans 'provided' jar dependencies</p>
</li>
<li>
<p>2.2.1 Release - Fixed issue with binary plugins in war build not including assets</p>
</li>
</ul>
</div>
</li>
<li>
<p>March 5, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.1.4 Release - Removed some debug printlns. Whoops!</p>
</li>
</ul>
</div>
</li>
<li>
<p>February 25, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.1.3 Release - Fixed bug preventing images / non processable entities from being loaded from binary plugins.</p>
</li>
<li>
<p>2.1.2 Release - Performance Improvement on scanning classpath for binary plugin assets</p>
</li>
</ul>
</div>
</li>
<li>
<p>January 28, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.1.1 Release - Fixed Binary / Classpath Resolver Support. Now scans META-INF/assets, META-INF/static, and META-INF/resources (yes that means webjars).</p>
</li>
</ul>
</div>
</li>
<li>
<p>January 5, 2015</p>
<div class="ulist">
<ul>
<li>
<p>2.1.0 Release - Fixed bug in CSS Processor breaking asset compile</p>
</li>
</ul>
</div>
</li>
<li>
<p>December 31, 2014</p>
<div class="ulist">
<ul>
<li>
<p>2.0.21 Release - Nested Grails related asset-pipeline classes into the asset.pipeline.grails package so that the asset.pipeline package does not get marked reloadable</p>
</li>
</ul>
</div>
</li>
<li>
<p>December 29, 2014</p>
<div class="ulist">
<ul>
<li>
<p>2.0.20 Release - Fixed bug in CSSProcessor and cache digest names, Fixed absolute path issue, documentation improvements, resolver improvements</p>
</li>
</ul>
</div>
</li>
<li>
<p>December 10, 2014</p>
<div class="ulist">
<ul>
<li>
<p>2.0.17 Release - Fixed bug in CSSProcessor for recalculating relative paths</p>
</li>
<li>
<p>2.0.16 Release - Fixed bug on 2nd war compile with Windows Platforms</p>
</li>
</ul>
</div>
</li>
<li>
<p>December 5, 2014</p>
<div class="ulist">
<ul>
<li>
<p>2.0.14 Release - Fixed compileDir for maven based builds</p>
</li>
</ul>
</div>
</li>
<li>
<p>December 3, 2014</p>
<div class="ulist">
<ul>
<li>
<p>2.0.13 Release - Faster Dev Mode, Fixed bug in war build, Fixed Css Processor with image paths. Fixed files with spaces.</p>
</li>
<li>
<p>2.0.11 Release - We no longer export groovy,groovy-templates dependency since grails uses groovy-all</p>
</li>
<li>
<p>2.0.10 Release - Fixed a bug in require_tree directive being a little too grabby. Also fixed windows platform support.</p>
</li>
</ul>
</div>
</li>
<li>
<p>December 2, 2014</p>
<div class="ulist">
<ul>
<li>
<p>2.0.8 Release - Moved to the new Asset-Pipeline-Core library with 2x faster compiling, binary plugin support, sourcemaps and more.</p>
</li>
</ul>
</div>
</li>
<li>
<p>July 29, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.9.6 Release - Whoops I had a typo. Thanks Travis.ci</p>
</li>
</ul>
</div>
</li>
<li>
<p>July 29, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.9.5 Release - Fixed Windows Platform Bug in CSS. Upgraded to UglifyJS2.0</p>
</li>
</ul>
</div>
</li>
<li>
<p>July 11, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.9.3 Release - Fixed ETag Headers for non-digested files, and updated project docs.</p>
</li>
</ul>
</div>
</li>
<li>
<p>July 10, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.9.2 Release - Fixed bug in cache manager, updated docs.</p>
</li>
<li>
<p>1.9.1 Release - Added commons-io dependency for more recent versions of grails.</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 28, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.9.0 Release - Added Absolute Image Support, Various bug fixes. Documentation Improvements.</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 6, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.8.11 Release - require_tree directive now falls back to absolute references if path doesn&#8217;t exist relatively</p>
</li>
</ul>
</div>
</li>
<li>
<p>June 1, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.8.10 Release - Added Support for comma delimited require lists</p>
</li>
</ul>
</div>
</li>
<li>
<p>April 30, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.8.7 Release - ETag Header Support and Vary: Accept-Encoding</p>
</li>
</ul>
</div>
</li>
<li>
<p>April 29, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.8.6 Release - AssetResourceLocator fix</p>
</li>
</ul>
</div>
</li>
<li>
<p>April 28, 2014</p>
<div class="ulist">
<ul>
<li>
<p>1.8.5 Release - GGTS and STS Eclipse Groovy Compiler Fixes</p>
</li>
<li>
<p>1.8.4 Release - GGTS and STS Eclipse Groovy Compiler Fixes</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 13, 2013</p>
<div class="ulist">
<ul>
<li>
<p>1.0.1 release</p>
</li>
</ul>
</div>
</li>
<li>
<p>October 28, 2013</p>
<div class="ulist">
<ul>
<li>
<p>1.0.2 release</p>
</li>
</ul>
</div>
</li>
<li>
<p>November 22, 2013</p>
<div class="ulist">
<ul>
<li>
<p>1.1.2 Release</p>
</li>
<li>
<p>1.1.3 Release</p>
</li>
</ul>
</div>
</li>
</ul>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="concepts">Concepts</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Asset-pipeline is a highly extensible asset processing library that is easy to integrate into your jvm based application or to even use standalone with gradle. It works by defining <code>AssetFile</code> definitions for different file types in which <code>Processors</code> can be chained for processing and conversion to different target content types. But to use it you don&#8217;t really need to know about any of this (It really does just work).</p>
</div>
<div class="sect2">
<h3 id="directives">Directives</h3>
<div class="paragraph">
<p>Similar to other packaging libraries like webpack or grunt, asset-pipeline provides a means to require other files or "modules" into your javascript and/or css. We will call these require patterns <code>directives</code>.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Asset-pipeline chooses to be dependency syntax agnostic. This makes it very easy to add in extension modules for things like CommonJS.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In asset-pipeline it is a common pattern to list all requirements of your file at the top in a comments section but this is not required. Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">//This is a JavaScript file with its top level require directives</span>
<span class="comment">//= require jquery</span>
<span class="comment">//= require app/models.js</span>
<span class="comment">//= require_tree views</span>
<span class="comment">//= require_self</span>

console.log(<span class="string"><span class="delimiter">&quot;</span><span class="content">This is my javascript manifest</span><span class="delimiter">&quot;</span></span>);</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or similarly a CSS file might look like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="css"><span class="comment">/*
This is a comment block in the top of a css file
*= require bootstrap
*= require font-awesome
*= require navigation/header.css
*= require_tree components
*/</span>

<span class="tag">body</span> {
  <span class="key">font-size</span>: <span class="float">12px</span>;
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This may look very simple at first but can become really quite powerful. For example, these directives can be nested in other files that you might include. This allows the asset-pipeline to build a dependency-graph, eliminating duplicate requirements, and ensuring everything is loaded in the most optimal order possible.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Requirement directives are recursively scanned within each required file, not just the first file.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>One other cool aspect of these require directives is the extension is not mandatory. Asset-pipeline will automatically look for any file matching that name (minus the extension) that has a registered <code>AssetFile</code> capable of converting it to the intended target file type. i.e. that Bootstrap directive could be including a LESS file or the javascript could easily include a Coffeescript file.</p>
</div>
<div class="sect3">
<h4 id="encoding">Encoding</h4>
<div class="paragraph">
<p>In some cases it may be necessary to specify an encoding for your assets. An example might be for Japanese characters in a JavaScript file. To do this, two things must be done. First, we simply set the charset attribute when we include are JavaScript file:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;script</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application.js</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">charset</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">utf-8</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>This should take care of testing in development mode and debugging. However, when we move to production/WAR mode the precompiler has no way to infer the desired encoding for compilation. To accomplish this, we have the <code>//= encoding</code> directive. This can be placed at the top of your <code>application.js</code> to define the desired compilation encoding.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">//=encoding UTF-8</span>
<span class="comment">//=require_self</span>
<span class="comment">//=require_tree .</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>That&#8217;s all there is to it.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="common-js">Common Js</h3>
<div class="paragraph">
<p>As of asset-pipeline 2.10.x CommonJs support was added. This is automatically detected in any javascript file and assets are automatically resolved within the project structure of asset-pipeline just like any other directive processor (i.e. <code>var React = require('react');</code>). If your project has conflicts with commonJs it can be turned off by setting the <code>configOptions</code> in gradle and in <code>grails.assets</code> config.</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">assets {
  configOptions = [<span class="key">commonJs</span>: <span class="predefined-constant">false</span>] <span class="comment">//useful for custom config on extension libraries</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>or:</p>
</div>
<div class="listingblock">
<div class="title">application.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails {
  assets {
    commonJs = <span class="predefined-constant">false</span>
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="project-structure">Project Structure</h3>
<div class="paragraph">
<p>Depending on which framework integration is being used (or even if no framework integration is being used) the project of the asset-pipeline files can slightly differ. However, typically this only affects the source folder location while all other aspects of the project structure remain the same.</p>
</div>
<div class="paragraph">
<p>By default assets live in the <code>src/assets</code> directory of the project (except in the case of grails where these live in <code>grails-app/assets</code>). However, files should not live at this direct root level and by default asset-pipeline will not detect them if they were. It is a conventional practice that files be organized in one level down subfolders. For example, in a base grails app the following folder structure is used and encouraged:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>assets/javascripts</code></p>
</li>
<li>
<p><code>assets/stylesheets</code></p>
</li>
<li>
<p><code>assets/images</code></p>
</li>
<li>
<p><code>assets/libs</code>&#8201;&#8212;&#8201;common naming for components that contain both css/javascript/images</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Asset-pipeline will automatically add any subfolder in the <code>assets</code> directory as a <code>FileResolver</code>. Meaning each folder is treated as a root level resolver path. It is also important to note that asset-pipeline does not actually care what file types go where. This is purely for the organizational benefit of the project.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
When requiring files using require directives do not include these directory names, treat them as root level traversal.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="search-paths">Search Paths</h3>
<div class="paragraph">
<p>When a file is referenced via a require directive or web request, the asset-pipeline checks for the file in several locations.</p>
</div>
<div class="paragraph">
<p>First it tries to find the file relative to the manifest including it. For example "admin/application.js" looking for "table.js"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// FileName: admin/application.js</span>
<span class="comment">//= require table</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first place we will look is within <code>src/assets/javascripts/admin/*</code> We will proceed to do this within all of the asset sub folders across plugins after the main application is searched.</p>
</div>
<div class="paragraph">
<p>The next place we will look is the root of all src/assets plugin sub folders (e.g. <code>src/assets/*/table.js</code>).</p>
</div>
<div class="paragraph">
<p>Finally all binary plugins are scanned in the <code>classpath:META-INF/assets</code> folder, <code>classpath:META-INF/static</code> and <code>classpath:META-INF/resources</code>.</p>
</div>
<div class="paragraph">
<p>In all cases, the applications assets folder takes precedence between the search paths, but plugins get scanned as well.</p>
</div>
</div>
<div class="sect2">
<h3 id="build-structure">Build Structure</h3>
<div class="paragraph">
<p>When the project is built (in Gradle that&#8217;s the <code>assetCompile</code> task) these folders are flattened and merged. Meaning this first level subdirectory structure disappears and all files are copied into <code>build/assets</code>. These files also get md5 digested names for cache busting as well as GZIP versions for compressed file serving (except already compressed images).</p>
</div>
<div class="paragraph">
<p>In a Java based framework any type of WAR or JAR packaging typically gets detected and assets are automatically moved into <code>classpath:assets</code> along with a file <code>classpath:assets/manifest.properties</code>. This manifest is a list of every file that was packaged by the asset-pipeline as the key, and the digested name equivalent as the value. This facilitates easy differential syncing between CDNS (like an s3 bucket for cloudfront) as well as fast and easy generation of ETag headers when serving assets from the application (more on this later).</p>
</div>
</div>
<div class="sect2">
<h3 id="relative-urls">Relative Urls</h3>
<div class="paragraph">
<p>With all this renaming of assets with digested names as well as slight restructuring between source and build, what happens with url references specified in <code>CSS</code> as well as <code>HTML</code>. This is where some familiar with the Ruby on Rails sprockets based asset-pipeline might remember the need for erb helpers to specify path replacement. The asset-pipeline for the JVM, however, takes a different more automatic approach:</p>
</div>
<div class="paragraph">
<p>All CSS type files go through a processor called the <code>CssProcessor</code>. This processor looks for any <code>url(../path/to/file.png)</code> type patterns and automatically resolves the asset from the asset-pipeline. If it finds the matching file, the url is automatically replaced with the correct url pattern including the digest name: <code>url(path/file-dadvbfgdaf123e.png)</code>.</p>
</div>
<div class="paragraph">
<p>This relative url replacement is really handy because any external css library that is included in your project (i.e. bootstrap) can be used as is without any need to sift through its code and replace url patterns to match. This feature is also performend on <code>HTML</code> files.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
HTML files automatically get relative url replacement making it easy to generate 100% static websites without any need for a dynamic templating engine.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Currently javascript is not scanned for relative path replacement. It is now possible to reference assets from your javascript using a precompiler directive in your code called <code>asset_url</code>. It is not relative and always produces an absolute path response which can be configured via the <code>mapping</code> config option which defaults to 'assets':</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript">---
<span class="keyword">var</span> logo = asset_url(<span class="string"><span class="delimiter">'</span><span class="content">grails_logo.png</span><span class="delimiter">'</span></span>);</code></pre>
</div>
</div>
<hr>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
This method is not evaluated in javascript but rather replaced like a precompiler directive.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="gradle">Gradle</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section of the documentation discusses configuration and setup of the asset-pipeline gradle plugin. Most framework integrations use this plugin for builds so it is important to know how it works.</p>
</div>
<div class="sect2">
<h3 id="getting-started">Getting Started</h3>
<div class="paragraph">
<p>Getting started with gradle is very quick and easy. The <code>asset-pipeline-gradle</code> plugin is included in both the gradle plugin repository as well as jcenter and maven. For those of you not familiar with <a href="http://gradle.org">gradle</a> it is a very powerful build tooling system that you should definitely check out.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Asset-Pipelines build classes are not directly dependent on gradle and can be easily integrated into other build tooling frameworks like Maven.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>In its simplest form the <code>build.gradle</code> file might look like this:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">buildscript {
  repositories {
    maven {
      url "https://plugins.gradle.org/m2/"
    }
  }
  dependencies {
    classpath "com.bertramlabs.plugins:asset-pipeline-gradle:2.12.10"
  }
}

apply plugin: "com.bertramlabs.asset-pipeline"</code></pre>
</div>
</div>
<div class="paragraph">
<p>Or even simpler:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">//gradle 2.1+
plugins {
  id "com.bertramlabs.asset-pipeline" version "2.12.10"
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>When this plugin is added a couple tasks and extensions are automatically registered:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>assetCompile</code> - Compiles and packages assets from <code>src/assets</code> into <code>build/assets</code></p>
</li>
<li>
<p><code>assetPackage</code> - Copies all assets unprocessed into an archive useful for plugin jars similar to webjars.</p>
</li>
<li>
<p><code>assetClean</code> - Cleans and resets the <code>build/assets</code> directory.</p>
</li>
</ul>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
All of these tasks support Gradle&#8217;s incubating continuous build feature. Simply prefix the task with <code>-t</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Create a folder <code>src/assets</code> and subfolders:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>javascripts</code></p>
</li>
<li>
<p><code>stylesheets</code></p>
</li>
<li>
<p><code>html</code></p>
</li>
<li>
<p><code>images</code></p>
</li>
<li>
<p><code>&#8230;&#8203;</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Now assets can be packaged and processed with ease and performance far outpacing other static asset build tooling.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Including javascript libraries and css libraries from npm is super easy as well. Check out <a href="https://twitter.com/craigburke">@craigburke</a>'s awesome gradle plugin <a href="https://github.com/craigburke/client-dependencies-gradle">client-dependencies-gradle</a>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="configuration">Configuration</h3>
<div class="paragraph">
<p>The asset-pipeline gradle plugin provides several very useful configuration options. An extension called <code>assets</code> is automatically added to Gradle when the plugin is applied that provides several options:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">assets {
  minifyJs = <span class="predefined-constant">true</span>
  minifyCss = <span class="predefined-constant">true</span>
  enableSourceMaps = <span class="predefined-constant">true</span>
  configOptions = [:] <span class="comment">//useful for custom config on extension libraries</span>

  minifyOptions = [
    <span class="key">optimizationLevel</span>: <span class="string"><span class="delimiter">'</span><span class="content">SIMPLE</span><span class="delimiter">'</span></span>,
    <span class="key">angularPass</span>: <span class="predefined-constant">true</span> <span class="comment">// Can use @ngInject annotation for Angular Apps</span>
  ]

  includes = <span class="type">[]</span>
  excludes = [<span class="string"><span class="delimiter">'</span><span class="content">**/*.less</span><span class="delimiter">'</span></span>] <span class="comment">//Example Exclude GLOB pattern</span>

  <span class="comment">//for plugin packaging</span>
  packagePlugin=<span class="predefined-constant">false</span> <span class="comment">//set to true if this is a library</span>

  <span class="comment">//developmentRuntime can be turned off</span>
  developmentRuntime=<span class="predefined-constant">true</span>

  <span class="comment">//if you want to customize the jar task this task runs on you can specify a jarTaskName</span>
  jarTaskName=<span class="predefined-constant">null</span>

  <span class="comment">// Can add custom asset locations (directories or individual jar files)</span>
  from <span class="string"><span class="delimiter">'</span><span class="content">/vendor/lib</span><span class="delimiter">'</span></span>
  from <span class="string"><span class="delimiter">'</span><span class="content">/path/to/file.jar</span><span class="delimiter">'</span></span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The default settings will work for most projects, but if one wanted to add a custom source file location the <code>from</code> directive can be quite useful. Asset-pipeline&#8217;s broad <code>Resolver</code> support makes it easy to include assets from a diverse set of locations (even webjars).</p>
</div>
<div class="paragraph">
<p>A common configuration change for assets may be the includes/excludes patterns. These allow one to specify specific files that should not be individually required or compiled because it does not make sense for them to be individually compiled. In the example above: all <code>.less</code> files are excluded. This does not exclude processing however when a <code>require</code> directive is used making it very easy to only package and bundle assets that the final website needs. It is also important to note that these patterns do not have to be <code>GLOB</code> patterns but can also be regular expressions by prefixing the pattern with <code>regex:</code>. By default all files prefixed with an underscore are automatically excluded from individual processing (similar to SASS).</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Tuning the includes/excludes patterns can dramatically reduce the build time of your project.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Some additional options are also provided for configuring what types of output assets are generated:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">assets {
  enableDigests = <span class="predefined-constant">true</span>
  skipNonDigests = <span class="predefined-constant">false</span>
  enableGzip = <span class="predefined-constant">true</span>
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default both digested named versions of assets as well as non digested named versions are generated as well as the gzip equivalents. Some frameworks dont actually need the non digested named versions ( <code>ratpack</code>, <code>grails</code>, <code>spring-boot</code>, and <code>servlets</code>). These frameworks take advantage of the <code>manifest.properties</code> file discussed earlier in the documentation to properly map requests for non digested file names to the digested equivalent and preserve compatibility with libraries that may not work well with digested file names.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Change <code>skipNonDigests</code> to true to help reduce the file size of your final generated project.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="jvm-based-dependencies">JVM Based Dependencies</h3>
<div class="paragraph">
<p>When working on any jvm based gradle project, the asset-pipeline plugin automatically detects all dependencies on the classpath and scans them for assets. This makes it easy to package assets in shared libraries for multiple apps to use or to even include assets that are included from a <a href="http://www.webjars.org">webjar</a> dependency.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If a library is simply a webjar or asset library, these packages are not needed in your final application package and can be set to <code>provided</code> or <code>compileOnly</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>When using asset-pipeline plugins for processing <code>LESS</code> files or other custom extensions they typically need to be both in the development runtime classpath as well as the build classpath. This is because asset-pipeline provides on the fly asset compilation during development for more rapid iteration cycles. To make this simpler a configuration dependency type is automatically added called assets:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
  // Example additional LESS support
  assets 'com.bertramlabs.plugins:less-asset-pipeline:2.12.10'
}</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="grails3">Grails 3</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section of the documentation discusses configuration and setup of the asset-pipeline plugin for Grails 3 based applications. Grails is the first jvm framework the asset-pipeline supported and was officially made standard in Grails 2.4 in order to replace the deprecated <code>resources</code> plugin. This also covers differences in the asset-pipeline configuration for development runtime as well as provided taglibs.</p>
</div>
<div class="sect2">
<h3 id="getting-started-2">Getting Started</h3>
<div class="paragraph">
<p>In Grails 3 most assets live in the <code>grails-app/assets</code> directory. This folder is automatically generated for you along with the organizational subdirectories <code>javascripts</code>, <code>images</code>, and <code>stylesheets</code>.</p>
</div>
<div class="paragraph">
<p>To get started simply add asset-pipeline to your <code>build.gradle</code> file (See Gradle usage). And the grails plugin to the dependencies block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
  runtime 'com.bertramlabs.plugins:asset-pipeline-grails:2.12.10'
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="development-runtime">Development Runtime</h4>
<div class="paragraph">
<p>A great feature built into grails is its development runtime support. All assets that are used in your gsp files are automatically generated and processed on the fly when requested. This means when a change is made in a css file or javascript file, the results are instant. A refresh of the page will reflect the changes without needing to wait for any type of <code>FileWatcher</code>. These results are also cached making it highly performant as your project grows.</p>
</div>
<div class="paragraph">
<p>Another great aspect of development runtime with grails is each file will individually be required in the gsp. A dependency graph is generated and each file is required individually to make it easy to debug javascript errors and stylesheet errors. While sourcemap support is integrated for javascript, this is not supported in a lot of browsers developers still target compatibility for. It is possible to disable this feature via configuration or simply testing your app with the embedded tomcat war to see how post minified and bundled assets will behave.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-2">Configuration</h3>
<div class="paragraph">
<p>Asset-Pipeline has several configuration options for use with grails 3. For most cases the configuration options listed in the Gradle guide pertain to grails3. Some subtle differences is the concept of development runtime vs. build time. If you want settings to apply to both development runtime and build time the properties have to be duplicated in your applications <code>application.yml</code> project. This is currently a limitation in how grails reads configuration files and gradle conveys properties.</p>
</div>
<div class="paragraph">
<p>Most build time options like <code>skipNonDigests</code> or <code>enableGzip</code> will never need specified in this YAML file as they will never be used during development runtime. It is also possible to disable development runtime entirely. In this scenario assets will always be packaged with the application and not monitored for changes unless gradle continuous build is utilized. Simply set <code>assets { developmentRuntime = false}</code> in your <code>build.gradle</code> file.</p>
</div>
<div class="paragraph">
<p>Example yaml:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yml"><span class="key">grails</span>:
  <span class="key">assets</span>:
    <span class="key">bundle</span>: <span class="string"><span class="content">true</span></span> <span class="comment">#dont individually require files in development</span>
    <span class="key">storagePath</span>: <span class="string"><span class="content">/path/to/store</span></span> <span class="comment">#automatically copy assets to external folder on startup</span></code></pre>
</div>
</div>
<div class="sect3">
<h4 id="mappings-and-asset-taglib-urls">Mappings and Asset Taglib URLs</h4>
<div class="paragraph">
<p>In many cases you may want to change the URL for which to include your static assets. This can be useful when using a CDN or perhaps even using nginx to serve your static assets.</p>
</div>
<div class="paragraph">
<p>To change the URL for your taglibs use the following configuration option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yml"><span class="key">grails</span>:
  <span class="key">assets</span>:
    <span class="key">url</span>: <span class="string"><span class="content">http://cdn.example.com/</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now your files are going to reference the CDN when running in the production environment. To go with this feature, you can have your application automatically copy your asset files out of your base WAR file on startup of your application. Optionally the asset URL config can also be defined as a closure that takes a request argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.assets.url = { request -&gt;
        <span class="keyword">if</span>(request.isSecure()) {
                <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">https://cdn.example.com/</span><span class="delimiter">&quot;</span></span>
        } <span class="keyword">else</span> {
                <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">http://cdn.example.com/</span><span class="delimiter">&quot;</span></span>
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows more fine grained control of your asset URLs based on the incoming request. An example, might be SSL detection or even changing CDN region by source IP.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
To use an asset closure config must be placed in an <code>application.groovy</code> file instead of <code>application.yml</code>
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yml"><span class="key">grails</span>:
  <span class="key">assets</span>:
    <span class="key">storagePath</span>: <span class="string"><span class="content">/var/cdn/path</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also change the default Tomcat path for both debugging and file inclusion using the <code>mapping</code> config option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="yml"><span class="key">grails</span>:
  <span class="key">assets</span>:
    <span class="key">mapping</span>: <span class="string"><span class="content">assets</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For all these configuration options, you will want to put these config values in the appropriate environment in <code>application.yml</code> or in groovy format in <code>application.groovy</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="organization">Organization</h3>
<div class="paragraph">
<p>Asset pipeline organization occurs within the "grails-app/assets" folder. This folder can exist within both the main application as well as a plugin.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A plugin will also include its web-app directory to better deal with plugins that wish to support both the resources plugin as well as asset-pipeline.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Within the <code>grails-app/assets</code> directory are several subfolders</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>grails-app/assets/javascripts</code></p>
</li>
<li>
<p><code>grails-app/assets/stylesheets</code></p>
</li>
<li>
<p><code>grails-app/assets/images</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A common folder that gets added to this set of organization is a "lib" folder. This folder can be useful in organizing third party libraries like jQuery, or Bootstrap.</p>
</div>
<div class="sect3">
<h4 id="plugins">Plugins</h4>
<div class="paragraph">
<p>Plugins also can have the same "grails-app/assets" folder and their URL mapping is also the same. This means it can be more important to ensure unique naming / path mapping between plugins. This is also powerful in the sense that a plugin can add helper manifests to be used within your apps like jquery, bootstrap, font-awesome, and more.</p>
</div>
<div class="paragraph">
<p>Plugins should make sure that the <code>assets { packagePlugin }</code> property is set to true in their <code>build.gradle</code> file otherwise assets will not properly be packaged into the plugin for use by the application.</p>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Plugins with assets must have the <code>packagePlugin</code> property set to true on the assets extension in <code>build.gradle</code>
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If, in the event, a file within a plugin needs to be overridden within your application, simply create the same file with the same relative path to <code>grails-app/assets</code> and it will override / take precedence over the plugin. More on that later.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Since plugins share the same file structure for assets, as well as web-app. It can become more important to "namespace" your plugins by creating further nested folders. (i.e. the plugin SpudCore puts its application.js file within <code>grails-app/assets/javascripts/spud/admin/application.js</code>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="search-paths-2">Search Paths</h4>
<div class="paragraph">
<p>When a file is referenced via a taglib or a manifest require directive, the asset-pipeline checks for the file in several locations.</p>
</div>
<div class="paragraph">
<p>First it tries to find the file relative to the manifest including it. For example "admin/application.js" looking for "table.js"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// FileName: admin/application.js</span>
<span class="comment">//= require table</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first place we will look is within <code>grails-app/assets/javascripts/admin/*</code> We will proceed to do this within all of the asset sub folders across plugins after the main application is searched.</p>
</div>
<div class="paragraph">
<p>The next place we will look is the root of all grails-app/assets plugin sub folders (e.g. <code>grails-app/assets/<strong>/table.js</code>, and <code>web-app/</strong>/table.js</code> for plugins).</p>
</div>
<div class="paragraph">
<p>Finally all binary plugins are scanned in the <code>classpath:META-INF/assets</code> folder, <code>classpath:META-INF/static</code> and <code>classpath:META-INF/resources</code>.</p>
</div>
<div class="paragraph">
<p>In all cases, the applications assets folder takes precedence between the search paths, but plugins get scanned as well.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These same conditions should be implemented on any preprocessor extension plugin, e.g. LESS-asset-pipeline follows the same scan for @import directives.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="taglibs">Taglibs</h3>
<div class="paragraph">
<p>Asset Pipeline adds a few new taglibs to properly reference your assets. These taglibs automatically handle swapout of cache digest names during production use as well as any custom URL mapping changes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;head&gt;</span>
  <span class="tag">&lt;asset:javascript</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application.js</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;asset:stylesheet</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application.css</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/head&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The primary include tags, as shown above, are quite useful for including your relevant JavaScript or stylesheet files. Notice that you do not have to prefix with '/assets', as this is handled automatically by the tag.</p>
</div>
<div class="paragraph">
<p>In GSP views, you can also reference images included in the asset-pipeline with the following tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;asset:image</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">logo.png</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">width</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">height</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Assets can also be referenced within subdirectories if required and simply require the use of the relative path.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;asset:image</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">icons/delete.png</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to return an assetPath as a string for injection in your own tags:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${assetPath(src: 'manifest.json')}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to execute a code section only if an asset exists or to simply test for existence</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;asset:assetPathExists</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">test.js</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
This will only be displayed if the asset exists
<span class="tag">&lt;/asset:assetPathExists&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html">asset.assetPathExists(src: 'test.js') //returns true or false</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="getting-resource">Getting Resource</h4>
<div class="paragraph">
<p>As of version 0.8.2 a new bean exists called <code>assetResourceLocator</code> This can be used to find assets by URI in both development and production mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html">class ExampleService {
  def assetResourceLocator

  def someMethod() {
    Resource myResource = assetResourceLocator.findAssetForURI('test.css')
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deferred-scripts">Deferred Scripts</h4>
<div class="paragraph">
<p>Asset-Pipeline provides a set of tags that can be used to ensure script blocks are deferred to the end of your page. This is not recommended as it is obtrusive, but has been added to help newcomers upgrade existing apps from resources.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;asset:javascript</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application.js</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">asset-defer</span><span class="tag">/&gt;</span>
<span class="tag">&lt;asset:script</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/javascript</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  console.log(&quot;Hello World&quot;);
<span class="tag">&lt;/asset:script&gt;</span>
<span class="tag">&lt;asset:script</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/javascript</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  console.log(&quot;Hello World 2&quot;);
<span class="tag">&lt;/asset:script&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now to render the output of these scripts simply use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="gsp">&lt;asset:deferredScripts/&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="grails2">Grails 2</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section of the documentation discusses configuration and setup of the asset-pipeline plugin for Grails 2 based applications. Grails is the first jvm framework the asset-pipeline supported and was officially made standard in Grails 2.4 in order to replace the deprecated <code>resources</code> plugin. This also covers differences in the asset-pipeline configuration and build process as it pertains to GANT instead of Gradle.</p>
</div>
<div class="sect2">
<h3 id="getting-started-3">Getting Started</h3>
<div class="paragraph">
<p>In Grails 2 most assets live in the <code>grails-app/assets</code> directory. On any Grails 2.4 or newer application this folder is automatically generated for you along with the organizational subdirectories <code>javascripts</code>, <code>images</code>, and <code>stylesheets</code>.</p>
</div>
<div class="paragraph">
<p>To get started with asset-pipeline for grails simply add asset-pipeline to the <code>BuildConfig.groovy</code></p>
</div>
<div class="listingblock">
<div class="title">BuildConfig.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">plugins {
  compile ":asset-pipeline:2.12.10"
  // Uncomment these to enable additional asset-pipeline capabilities
  //compile ":sass-asset-pipeline:2.12.10"
  //compile ":less-asset-pipeline:2.12.10"
  //compile ":coffee-asset-pipeline:2.12.10"
  //compile ":handlebars-asset-pipeline:2.12.10"
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
While there are grails 2 plugins for most add on modules like LESS and SASS, It is not required and the binary asset-pipeline module dependencies can be used instead in the <code>dependencies{}</code> block of <code>BuildConfig.groovy</code>.
</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="development-runtime-2">Development Runtime</h4>
<div class="paragraph">
<p>A great feature built into grails is its development runtime support. All assets that are used in your gsp files are automatically generated and processed on the fly when requested. This means when a change is made in a css file or javascript file, the results are instant. A refresh of the page will reflect the changes without needing to wait for any type of <code>FileWatcher</code>. These results are also cached making it highly performant as your project grows.</p>
</div>
<div class="paragraph">
<p>Another great aspect of development runtime with grails is each file will individually be required in the gsp. A dependency graph is generated and each file is required individually to make it easy to debug javascript errors and stylesheet errors. While sourcemap support is integrated for javascript, this is not supported in a lot of browsers developers still target compatibility for. It is possible to disable this feature via configuration or simply testing your app with <code>grails dev run-war</code> to see how post minified and bundled assets will behave.</p>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
Use <code>grails dev run-war</code> to test your apps behavior once assets are minified and bundled
.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="configuration-3">Configuration</h3>
<div class="paragraph">
<p>Asset-Pipeline has several customizable options to tweak the compiler to suit your needs. Below is a list of the various configuration options and explanations for how to use them.</p>
</div>
<div class="sect3">
<h4 id="excludes-and-includes">Excludes and Includes</h4>
<div class="paragraph">
<p>Certain files are not needed for compilation in production. This can be configured globally or for a specific plugin by using the provided configuration options:</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 1. Table Exclude Properties</caption>
<colgroup>
<col style="width: 50%;">
<col style="width: 50%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.assets.excludes, \["tiny_mce/src/\*.js"]</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.assets.plugin."twitter-bootstrap".excludes, \["*\*/\*.less"]</p></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Above you will notice the use of an includes. An includes allows you to override a specific file after the excludes scan has already been performed. The above example makes sure the @bootstrap.less@ file can be compiled from the @twitter-bootstrap plugin@.</p>
</div>
</div>
<div class="sect3">
<h4 id="minification">Minification</h4>
<div class="paragraph">
<p>The Asset-pipeline comes with the newer version of Closure Compiler to minify your JavaScript assets. This is great for compression and a few options are provided to tune the minifier. Closure can be enabled/disabled entirely as well as configured via various options.</p>
</div>
<table class="tableblock frame-all grid-all spread">
<caption class="title">Table 2. Table Build Options</caption>
<colgroup>
<col style="width: 33%;">
<col style="width: 33%;">
<col style="width: 33%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Property</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Value</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Default</p></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.assets.minifyJs, <strong>true</strong> or <strong>false</strong>, <strong>true</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.assets.minifyCss, <strong>true</strong> or <strong>false</strong>, <strong>true</strong></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">grails.assets.enableSourceMaps, <strong>true</strong> or <strong>false</strong>, <strong>true</strong></p></td>
</tr>
</tbody>
</table>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
It is normally not necessary to turn off 'skipNonDigests'. Tomcat will automatically still serve files by non digest name and will copy them out using storagePath via the <code>manifest.properties</code> alias map.
This simply cuts storage in half. However, if you are attempting to do things like upload to a cdn outside of the cdn-asset-pipeline plugin and via the contents of 'target/assets'. This may still be useful.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.assets.minifyOptions = [
    <span class="key">languageMode</span>: <span class="string"><span class="delimiter">'</span><span class="content">ES5</span><span class="delimiter">'</span></span>,
    <span class="key">targetLanguage</span>: <span class="string"><span class="delimiter">'</span><span class="content">ES5</span><span class="delimiter">'</span></span>, <span class="comment">//Can go from ES6 to ES5 for those bleeding edgers</span>
    <span class="key">optimizationLevel</span>: <span class="string"><span class="delimiter">'</span><span class="content">SIMPLE</span><span class="delimiter">'</span></span> <span class="comment">//Or ADVANCED or WHITESPACE_ONLY</span>
]</code></pre>
</div>
</div>
<div class="paragraph">
<p>Above are the default values for the majority of Closure Compiler. For specifics on what these options do please refer to the documentation for Closure Compiler.</p>
</div>
</div>
<div class="sect3">
<h4 id="mappings-and-asset-taglib-urls-2">Mappings and Asset Taglib URLs</h4>
<div class="paragraph">
<p>In many cases you may want to change the URL for which to include your static assets. This can be useful when using a CDN or perhaps even using nginx to serve your static assets.</p>
</div>
<div class="paragraph">
<p>To change the URL for your taglibs use the following configuration option:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.assets.url = <span class="string"><span class="delimiter">&quot;</span><span class="content">http://cdn.example.com/</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now your files are going to reference the CDN when running in the production environment. To go with this feature, you can have your application automatically copy your asset files out of your base WAR file on startup of your application. Optionally the asset URL config can also be defined as a closure that takes a request argument.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.assets.url = { request -&gt;
        <span class="keyword">if</span>(request.isSecure()) {
                <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">https://cdn.example.com/</span><span class="delimiter">&quot;</span></span>
        } <span class="keyword">else</span> {
                <span class="keyword">return</span> <span class="string"><span class="delimiter">&quot;</span><span class="content">http://cdn.example.com/</span><span class="delimiter">&quot;</span></span>
        }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This allows more fine grained control of your asset URLs based on the incoming request. An example, might be SSL detection or even changing CDN region by source IP.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.assets.storagePath = <span class="string"><span class="delimiter">&quot;</span><span class="content">/var/cdn/path</span><span class="delimiter">&quot;</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>You can also change the default Tomcat path for both debugging and file inclusion using the <code>mapping</code> config option.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">grails.assets.mapping = <span class="string"><span class="delimiter">'</span><span class="content">assets</span><span class="delimiter">'</span></span></code></pre>
</div>
</div>
<div class="paragraph">
<p>For all these configuration options, you will want to put these config values in the appropriate environment in <code>Config.groovy</code>.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="organization-2">Organization</h3>
<div class="paragraph">
<p>Asset pipeline organization occurs within the "grails-app/assets" folder. This folder can exist within both the main application as well as a plugin.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
A plugin will also include its web-app directory to better deal with plugins that wish to support both the resources plugin as well as asset-pipeline.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Within the <code>grails-app/assets</code> directory are several subfolders</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>grails-app/assets/javascripts</code></p>
</li>
<li>
<p><code>grails-app/assets/stylesheets</code></p>
</li>
<li>
<p><code>grails-app/assets/images</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>A common folder that gets added to this set of organization is a "lib" folder. This folder can be useful in organizing third party libraries like jQuery, or Bootstrap.</p>
</div>
<div class="sect3">
<h4 id="plugins-2">Plugins</h4>
<div class="paragraph">
<p>Plugins also can have the same "grails-app/assets" folder and their URL mapping is also the same. This means it can be more important to ensure unique naming / path mapping between plugins. This is also powerful in the sense that a plugin can add helper manifests to be used within your apps like jquery, bootstrap, font-awesome, and more.</p>
</div>
<div class="paragraph">
<p>These plugins also differ in the fact that the assets within their web-app directory also become available under a similar structure</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>web-app/css</code></p>
</li>
<li>
<p><code>web-app/js</code></p>
</li>
<li>
<p><code>web-app/img</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>These paths also get flattened just like the <code>grails-app/assets</code> folder does.</p>
</div>
<div class="paragraph">
<p>If, in the event, a file within a plugin needs to be overridden within your application, simply create the same file with the same relative path to <code>grails-app/assets</code> and it will override / take precedence over the plugin. More on that later.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Since plugins share the same file structure for assets, as well as web-app. It can become more important to "namespace" your plugins by creating further nested folders. (i.e. the plugin SpudCore puts its application.js file within <code>grails-app/assets/javascripts/spud/admin/application.js</code>).
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="search-paths-3">Search Paths</h4>
<div class="paragraph">
<p>When a file is referenced via a taglib or a manifest require directive, the asset-pipeline checks for the file in several locations.</p>
</div>
<div class="paragraph">
<p>First it tries to find the file relative to the manifest including it. For example "admin/application.js" looking for "table.js"</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="javascript"><span class="comment">// FileName: admin/application.js</span>
<span class="comment">//= require table</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The first place we will look is within <code>grails-app/assets/javascripts/admin/*</code> We will proceed to do this within all of the asset sub folders across plugins after the main application is searched.</p>
</div>
<div class="paragraph">
<p>The next place we will look is the root of all grails-app/assets plugin sub folders (e.g. <code>grails-app/assets/<strong>/table.js</code>, and <code>web-app/</strong>/table.js</code> for plugins).</p>
</div>
<div class="paragraph">
<p>Finally all binary plugins are scanned in the <code>classpath:META-INF/assets</code> folder, <code>classpath:META-INF/static</code> and <code>classpath:META-INF/resources</code>.</p>
</div>
<div class="paragraph">
<p>In all cases, the applications assets folder takes precedence between the search paths, but plugins get scanned as well.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
These same conditions should be implemented on any preprocessor extension plugin, e.g. LESS-asset-pipeline follows the same scan for @import directives.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="taglibs-2">Taglibs</h3>
<div class="paragraph">
<p>Asset Pipeline adds a few new taglibs to properly reference your assets. These taglibs automatically handle swapout of cache digest names during production use as well as any custom URL mapping changes.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;head&gt;</span>
  <span class="tag">&lt;asset:javascript</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application.js</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
  <span class="tag">&lt;asset:stylesheet</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application.css</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/head&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>The primary include tags, as shown above, are quite useful for including your relevant JavaScript or stylesheet files. Notice that you do not have to prefix with '/assets', as this is handled automatically by the tag.</p>
</div>
<div class="paragraph">
<p>In GSP views, you can also reference images included in the asset-pipeline with the following tag:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;asset:image</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">logo.png</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">width</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">height</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">200</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Assets can also be referenced within subdirectories if required and simply require the use of the relative path.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;asset:image</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">icons/delete.png</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to return an assetPath as a string for injection in your own tags:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;link</span> <span class="attribute-name">href</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">${assetPath(src: 'manifest.json')}</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>It is also possible to execute a code section only if an asset exists or to simply test for existence</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;asset:assetPathExists</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">test.js</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
This will only be displayed if the asset exists
<span class="tag">&lt;/asset:assetPathExists&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>or</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html">asset.assetPathExists(src: 'test.js') //returns true or false</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="getting-resource-2">Getting Resource</h4>
<div class="paragraph">
<p>As of version 0.8.2 a new bean exists called <code>assetResourceLocator</code> This can be used to find assets by URI in both development and production mode.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html">class ExampleService {
  def assetResourceLocator

  def someMethod() {
    Resource myResource = assetResourceLocator.findAssetForURI('test.css')
  }
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="deferred-scripts-2">Deferred Scripts</h4>
<div class="paragraph">
<p>Asset-Pipeline provides a set of tags that can be used to ensure script blocks are deferred to the end of your page. This is not recommended as it is obtrusive, but has been added to help newcomers upgrade existing apps from resources.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="html"><span class="tag">&lt;asset:javascript</span> <span class="attribute-name">src</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">application.js</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">asset-defer</span><span class="tag">/&gt;</span>
<span class="tag">&lt;asset:script</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/javascript</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  console.log(&quot;Hello World&quot;);
<span class="tag">&lt;/asset:script&gt;</span>
<span class="tag">&lt;asset:script</span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">text/javascript</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
  console.log(&quot;Hello World 2&quot;);
<span class="tag">&lt;/asset:script&gt;</span></code></pre>
</div>
</div>
<div class="paragraph">
<p>Now to render the output of these scripts simply use the following:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="gsp">&lt;asset:deferredScripts/&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="ratpack">Ratpack</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section of the documentation discusses configuration and setup of the asset-pipeline plugin for <a href="https://ratpack.io/">Ratpack</a> based applications. Ratpack functionality includes both development runtime and production asset serving capabilities. All features provided by asset-pipeline are available for use with Ratpack framework except template url replacement helpers (as this has not been standardized in the framework yet).</p>
</div>
<div class="sect2">
<h3 id="getting-started-4">Getting Started</h3>
<div class="paragraph">
<p>In Ratpack assets live in the same place as a standard gradle implementation <code>src/assets</code> directory. This folder should contain organizational subdirectories <code>javascripts</code>, <code>images</code>, and <code>stylesheets</code>.</p>
</div>
<div class="paragraph">
<p>To get started simply add asset-pipeline to your <code>build.gradle</code> file (See Gradle usage). And the ratpacks plugin to the dependencies block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
  runtime 'com.bertramlabs.plugins:ratpack-asset-pipeline:2.12.10'
  //Example LESS or Sass Integration
  //assets 'com.bertramlabs.plugins:less-asset-pipeline:2.12.10'
  //assets 'com.bertramlabs.plugins:sass-asset-pipeline:2.12.10'
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Asset-Pipeline requires ratpack-groovy to be used in a ratpack application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Finally the <code>AssetPipelineModule</code> needs added to the Ratpack Registry.</p>
</div>
<div class="listingblock">
<div class="title">ratpack.groovy</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">import</span> <span class="include">static</span> <span class="include">ratpack.groovy.Groovy.ratpack</span>
<span class="keyword">import</span> asset.pipeline.ratpack.AssetPipelineModule

ratpack {
  bindings {
    module(AssetPipelineModule) { cfg -&gt;
                <span class="comment">// by default /assets, change url mapping</span>
            <span class="comment">// cfg.url(&quot;/&quot;)</span>
            cfg.sourcePath(<span class="string"><span class="delimiter">&quot;</span><span class="content">../../../src/assets</span><span class="delimiter">&quot;</span></span>)
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This module does support a few configuration options and due to how the runtime works the sourcePath does need to be specified depending on if ratpack is being run in development from an IDE or gradle directly.</p>
</div>
<div class="paragraph">
<p>By default a Handler will be registered to the url <code>/assets</code> but it is also possible to simply use the <code>AssetPipelineHandler</code> directly or even change the base mapping config as seen in the example above.</p>
</div>
<div class="sect3">
<h4 id="development-runtime-3">Development Runtime</h4>
<div class="paragraph">
<p>A great feature built into asset-pipeline is its development runtime support. All assets that are used in your application are automatically generated and processed on the fly when requested. This means when a change is made in a css file or javascript file, the results are instant. A refresh of the page will reflect the changes without needing to wait for any type of <code>FileWatcher</code>. These results are also cached making it highly performant as your project grows.</p>
</div>
<div class="paragraph">
<p>Ratpack has great native continuous build integration support with Gradle and in some cases developers may not want to use the development runtime and instead rely on this continuous build flow. To do that simply disable developmentRuntime:</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">assets {
  developmentRuntime = <span class="predefined-constant">false</span>
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="spring-boot">Spring Boot</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section of the documentation discusses configuration and setup of the asset-pipeline plugin for <a href="http://projects.spring.io/spring-boot/">Spring Boot</a> based applications. Spring functionality includes both development runtime and production asset serving capabilities. All features provided by asset-pipeline are available for use with Ratpack framework except template url replacement helpers.</p>
</div>
<div class="sect2">
<h3 id="getting-started-5">Getting Started</h3>
<div class="paragraph">
<p>In Spring Boot assets live in the same place as a standard gradle implementation <code>src/assets</code> directory. This folder should contain organizational subdirectories <code>javascripts</code>, <code>images</code>, and <code>stylesheets</code>.</p>
</div>
<div class="paragraph">
<p>To get started simply add asset-pipeline to your <code>build.gradle</code> file (See Gradle usage). And the ratpacks plugin to the dependencies block:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
  runtime 'com.bertramlabs.plugins:asset-pipeline-spring-boot:2.12.10'
  //Example LESS or Sass Integration
  //assets 'com.bertramlabs.plugins:less-asset-pipeline:2.12.10'
  //assets 'com.bertramlabs.plugins:sass-asset-pipeline:2.12.10'
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Asset-Pipeline requires at least groovy 2.0.7 to be used within a spring boot application.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>It is also necessary to add <code>ComponentScan</code> to your application class in order for the asset-pipeline plugin to properly initialize.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="keyword">package</span> demo

<span class="annotation">@Configuration</span>
<span class="annotation">@ComponentScan</span>([<span class="string"><span class="delimiter">'</span><span class="content">demo</span><span class="delimiter">'</span></span>,<span class="string"><span class="delimiter">'</span><span class="content">asset.pipeline.springboot</span><span class="delimiter">'</span></span>])
<span class="annotation">@EnableAutoConfiguration</span>
<span class="type">class</span> <span class="class">Application</span> {

    <span class="directive">static</span> <span class="type">void</span> main(<span class="predefined-type">String</span><span class="type">[]</span> args) {
        SpringApplication.run Application, args
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>By default a servlet filter will be registered to the url <code>/assets</code> from which all assets will be served.</p>
</div>
<div class="sect3">
<h4 id="development-runtime-4">Development Runtime</h4>
<div class="paragraph">
<p>A great feature built into asset-pipeline is its development runtime support. All assets that are used in your application are automatically generated and processed on the fly when requested. This means when a change is made in a css file or javascript file, the results are instant. A refresh of the page will reflect the changes without needing to wait for any type of <code>FileWatcher</code>. These results are also cached making it highly performant as your project grows.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="modules">Plugin Modules</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Asset-pipeline comes out of the box with modules for processing several common asset types. These include LESS, SASS, Coffeescript, Handlebars, and more. There are also several third party modules created by developers for Typescript, JSX, etc.</p>
</div>
<div class="sect2">
<h3 id="less">LESS</h3>
<div class="paragraph">
<p>With the LESS module it is easy to automatically compile LESS files down to the native browser CSS format. By default the <code>less-asset-pipeline</code> plugin takes advantage of Less4j for highly performant LESS compilation. If the standard compiler is desired this can also be enabled however it is dramatically slower due to running in a javascript environment.</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
  assets 'com.bertramlabs.plugins:less-asset-pipeline:2.12.10'
}</code></pre>
</div>
</div>
<div class="sect3">
<h4 id="configuration-4">Configuration</h4>
<div class="paragraph">
<p>To switch to the standard compiler simply adjust the <code>less.compiler</code> property to 'standard':</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">assets {
    configOptions = [
      <span class="key">less</span>: [
        <span class="key">compiler</span>: <span class="string"><span class="delimiter">'</span><span class="content">standard</span><span class="delimiter">'</span></span>
      ]
    ]
}</code></pre>
</div>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<div class="title">Tip</div>
</td>
<td class="content">
During war build your <code>less</code> files are compiled into css files. This is all well and good but sometimes you dont want each individual <code>less</code> file compiled, but rather your main base <code>less</code> file. It may be best to add a sub folder for those LESS files and exclude it in your precompile config.
</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="sass">SASS</h3>
<div class="paragraph">
<p>The SASS module provides easy processing and implementation of <code>scss</code> and <code>sass</code> files. It uses libsass for highly performant compiling of SASS files and automatically handles asset resolution correctly.</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
  assets 'com.bertramlabs.plugins:sass-asset-pipeline:2.12.10'
}</code></pre>
</div>
</div>
<div class="admonitionblock important">
<table>
<tr>
<td class="icon">
<div class="title">Important</div>
</td>
<td class="content">
Before 2.9.0 sass-asset-pipeline used jruby and compass. This version of the plugin has been renamed to compass-asset-pipeline.
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="coffeescript">Coffeescript</h3>
<div class="paragraph">
<p>The Coffee Asset-Pipeline module provides coffeescript compilation support for the jvm based asset-pipeline. Simply add this file to your buildscript classpath or development environment and they are automatically processed.</p>
</div>
<div class="listingblock">
<div class="title">build.gradle</div>
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">dependencies {
  assets 'com.bertramlabs.plugins:coffee-asset-pipeline:2.12.10'
}</code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
If the native coffeescript binary is detected in the build environment. Coffeescript processing will take advantage of this over internal javascript processing. Simply <code>npm install -g coffeescript</code>.
</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="extending">Extending</h2>
<div class="sectionbody">
<div class="paragraph">
<p>The asset-pipeline is extremely extensible and easy to customize to suit one&#8217;s needs. You might extend the asset-pipeline to handle a new type of asset that may need to be preprocessed before being served to the browser, or you may want to define a new custom directive. This guide will go over the basics of how to perform those tasks with ease.</p>
</div>
<div class="sect2">
<h3 id="asset-file-definition">Asset File Definition</h3>
<div class="paragraph">
<p>The <code>AssetFile</code> definition is where our journey begins. This is the defining file for various file types. Without this definition, the asset-pipeline will treat an unknown file type as a standard passthrough resource. As an example, lets first look at the <code>CssAssetFile</code> definition.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">CssAssetFile</span> <span class="directive">extends</span> AbstractAssetFile {
  <span class="directive">static</span> <span class="directive">final</span> <span class="predefined-type">String</span> contentType = <span class="string"><span class="delimiter">'</span><span class="content">text/css</span><span class="delimiter">'</span></span>
  <span class="directive">static</span> extensions = [<span class="string"><span class="delimiter">'</span><span class="content">css</span><span class="delimiter">'</span></span>]
  <span class="directive">static</span> compiledExtension = <span class="string"><span class="delimiter">'</span><span class="content">css</span><span class="delimiter">'</span></span>
  <span class="directive">static</span> processors = [CssProcessor]

  <span class="predefined-type">String</span> directiveForLine(<span class="predefined-type">String</span> line) {
    line.find(<span class="regexp"><span class="delimiter">/</span><span class="content">\*</span><span class="content">=(.*)</span><span class="delimiter">/</span></span>) { fullMatch, directive -&gt; <span class="keyword">return</span> directive }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>This file definition is pretty short but allows us to define some very useful information. First, we look at the static definitions at the top of the class. These static definitions are fairly easy to meta-override with Groovy and add additional processors or adjust with added plugins.</p>
</div>
<div class="paragraph">
<p>The <code>contentType</code> property is used to match a file definition with an incoming file request. When the browser requests a <code>text/css</code> content-type file , this file is matched and files matching this definition are scanned. The <code>extensions</code> list tells asset-pipeline which file extensions to scan through and match. In this case it is just 'css', but in the case of LESS for example, we may be looking for extensions <code>less</code>, or <code>css.less</code>.</p>
</div>
<div class="paragraph">
<p>The <code>compiledExtension</code> property tells asset-pipelines precompiler what the final file extension should be.</p>
</div>
<div class="paragraph">
<p>Finally, the <code>processors</code> array determines the list of processors that need be run on the file contents before returning a result. This array is executed in order. In this case, we have the <code>CssProcessor</code> (a processor for converting the relative image paths and replacing with their cache digested version).</p>
</div>
<div class="sect3">
<h4 id="directive-definition">Directive Definition</h4>
<div class="paragraph">
<p>An <code>assetFile</code> can specify a REGEXP pattern for require directives. These directives are used to bundle assets together. Some file types don&#8217;t utilize these require directives and simply returning a null value will cancel directive processing.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">  <span class="predefined-type">Pattern</span> directivePattern = ~<span class="regexp"><span class="delimiter">/</span><span class="content">(?m)</span><span class="content">\*</span><span class="content">=(.*)</span><span class="delimiter">/</span></span></code></pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Used to there was a <code>directiveForLine</code> that matched on each individual line. This was changed to support a multiline regex pattern for faster processing.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>The example above shows a match pattern for CSS files. This allows it to match require directives for the following example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="comment">/*
*= require_self
*= require_file example_b
*= require_tree .
*/</span>

body {
  margin-<span class="key">top</span>:<span class="integer">25</span>px;
}</code></pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="processing-data-streams">Processing Data Streams</h4>
<div class="paragraph">
<p>Processors are used to precompile certain assets, and/or adjust the file path contents. The Processor class itself will get a more in depth explanation in the next section. For now, the part we want to look at is the processedStream function.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="predefined-type">String</span> processedStream(<span class="predefined-type">Boolean</span> precompiler) {
  <span class="keyword">def</span> fileText
  <span class="keyword">def</span> skipCache = precompiler ?: (!processors || processors.size() == <span class="integer">0</span>)

  <span class="keyword">if</span>(baseFile?.encoding || encoding) {
    fileText = file?.getText(baseFile?.encoding ? baseFile.encoding : encoding)
  } <span class="keyword">else</span> {
    fileText = file?.text
  }

  <span class="keyword">def</span> md5 = AssetHelper.getByteDigest(fileText.bytes)
  <span class="keyword">if</span>(!skipCache) {
    <span class="keyword">def</span> cache = CacheManager.findCache(file.canonicalPath, md5)
    <span class="keyword">if</span>(cache) {
      <span class="keyword">return</span> cache
    }
  }
  <span class="keyword">for</span>(processor <span class="keyword">in</span> processors) {
    <span class="keyword">def</span> processInstance = processor.newInstance(precompiler)
    fileText = processInstance.process(fileText, <span class="local-variable">this</span>)
  }

  <span class="keyword">if</span>(!skipCache) {
    CacheManager.createCache(file.canonicalPath,md5,fileText)
  }

  <span class="keyword">return</span> fileText
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The example above iterates over all of the processor classes defined in our static <code>processors</code> variable. This creates a new instance and informs the processor whether this is a developer mode request or being issued by the precompiler (useful for determining if file replacements need to be cache digested or not). The <code>processedStream</code> method is now a part of the <code>AbstractAssetFile</code> definition and handles cache management if there are processors.</p>
</div>
</div>
<div class="sect3">
<h4 id="adding-the-asset-definiton-to-the-list-of-assetfiles">Adding the Asset definiton to the list of AssetFiles</h4>
<div class="paragraph">
<p>Originally we had to add these classes on startup in both runtime and build phases to the <code>AssetHelper.assetSpecs</code> array. Thanks to contributions by Graeme Rocher we have been able to simplify this process.
Simply adding a list file <code>META-INF/asset-pipeline/asset.specs</code> to the classpath will automatically get scanned.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">asset.pipeline.HtmlAssetFile
asset.pipeline.JsAssetFile
asset.pipeline.CssAssetFile</code></pre>
</div>
</div>
<div class="paragraph">
<p>Another autoscanning file allows us to tack on Processors to already registered AssetFile specifications. This is called the <code>processor.specs</code> file and goes in the same <code>META-INF/asset-pipeline</code> folder.
This is a Properties file with the key being the class path of the Processor and the value being a comma delimited list of <code>AssetFile</code> classes you want the processor added to.</p>
</div>
<div class="paragraph">
<p>Example:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy">asset.pipeline.CssProcessor=asset.pipeline.CssAssetFile,asset.pipeline.LessAssetFile</code></pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="processors">Processors</h3>
<div class="paragraph">
<p>Processors are where the real power of asset-pipeline comes into play. These are the driving force behind making compileable assets such as LESS, and CoffeeScript first class citizens. Gone is the need to run a compiler on the side, and gone is the delay between making changes in development.</p>
</div>
<div class="paragraph">
<p>A Processor is an implementation of the <code>Processor</code> interface via the <code>AbstractProcessor</code> class. It must have a constructor with an <code>AssetCompiler</code> argument, and it must have a process method. The rest is up to the developer.
The reason the AssetCompiler is passed is for giving the processor access to manipulate the precompiler phase. If a null precompiler is passed, than development mode is assumed and the processor can infer that. An example use case
for this is the SassProcessor in the SASS/SCSS Asset Pipeline Plugin. Image sprite generation causes additional image files to be created that need added to the list of files to process.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="groovy"><span class="type">class</span> <span class="class">CoffeeScriptProcessor</span> <span class="directive">extends</span> AbstractProcessor {

  Scriptable globalScope
  <span class="predefined-type">ClassLoader</span> classLoader

  CoffeeScriptProcessor(AssetCompiler precompiler){
    <span class="local-variable">super</span>(precompiler)
  }

  <span class="predefined-type">String</span> process(<span class="predefined-type">String</span> input, AssetFile assetFile) {
    <span class="keyword">try</span> {
      <span class="keyword">def</span> cx = <span class="predefined-type">Context</span>.enter()
      <span class="keyword">def</span> compileScope = cx.newObject(globalScope)
      compileScope.setParentScope(globalScope)
      compileScope.put(<span class="string"><span class="delimiter">&quot;</span><span class="content">coffeeScriptSrc</span><span class="delimiter">&quot;</span></span>, compileScope, input)
      <span class="keyword">def</span> result = cx.evaluateString(compileScope, <span class="string"><span class="delimiter">&quot;</span><span class="content">CoffeeScript.compile(coffeeScriptSrc)</span><span class="delimiter">&quot;</span></span>, <span class="string"><span class="delimiter">&quot;</span><span class="content">CoffeeScript compile command</span><span class="delimiter">&quot;</span></span>, <span class="integer">0</span>, <span class="predefined-constant">null</span>)
      <span class="keyword">return</span> result
    } <span class="keyword">catch</span> (<span class="exception">Exception</span> e) {
      <span class="keyword">throw</span> <span class="keyword">new</span> <span class="exception">Exception</span>(<span class="string"><span class="delimiter">&quot;&quot;&quot;</span><span class="content">
        CoffeeScript Engine compilation of coffeescript to javascript failed.
        </span><span class="inline"><span class="inline-delimiter">$</span>e</span><span class="content">
        </span><span class="delimiter">&quot;&quot;&quot;</span></span>)
    } <span class="keyword">finally</span> {
      <span class="predefined-type">Context</span>.exit()
    }
  }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Above is an excerpt of the <code>CoffeeScriptProcessor</code> plugin. This plugin takes advantage of RhinoJS to use the CoffeeScript compiler and provide the application with direct support for CoffeeScript files. The <code>process</code> method takes an input, as well as a reference to the asset file definition, and returns a result. To use your processor simply add it to your 'static processors' array on the <code>AssetFile</code> definition.</p>
</div>
<div class="paragraph">
<p>The <code>LESSProcessor</code> was not used in this example as it&#8217;s more complicated due to supporting the <code>@import</code> LESS directive and cache dependencies on the cache manager. However, it is a great example to look at and highly recommended.</p>
</div>
</div>
<div class="sect2">
<h3 id="post-processors">Post-Processors</h3>
<div class="paragraph">
<p>Currently, PostProcessor extensibility is not available. This is currently a feature we are implementing to provide easier dropin for custom minifiers and compressors.</p>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2016-05-23 16:43:15 -04:00
</div>
</div>
</body>
</html>